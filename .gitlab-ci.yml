stages:
  - prepare
  - scan

clear_security_issues:
  stage: prepare
  image: python:3.12
  before_script:
    - pip install httpx
  script:
    - python scripts/clear_gitlab_security_issues.py

hounddog:
  stage: scan
  allow_failure: true
  image:
    name: hounddogai/hounddog:$HOUNDDOG_DOCKER_IMAGE_TAG
    pull_policy: always
  script:
    - hounddog scan 
      --output-format=gitlab 
      --output-filename=hounddog.json
      --debug
    - cat hounddog.json
  artifacts:
    reports:
      sast: hounddog.json
